
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The barren plateau phenomenon &#8212; QMLCourse</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.e8f53015daec13862f6db5e763c41738.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://quantum-ods.github.io/qmlcourse/book/book/qnnblock/barrenplateau.html" />
    <link rel="shortcut icon" href="../../_static/qmlcourse_favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="–û –±–ª–æ–∫–µ ‚Äú–ü—Ä–æ–±–ª–µ–º—ã –∫–≤–∞–Ω—Ç–æ–≤–æ–≥–æ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è‚Äù" href="../problemsblock/problemsintro.html" />
    <link rel="prev" title="–°–≤–µ—Ä—Ç–æ—á–Ω—ã–µ –≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω—ã–µ –∫–≤–∞–Ω—Ç–æ–≤—ã–µ —Å—Ö–µ–º—ã" href="qconv.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      <img src="../../_static/logo.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">QMLCourse</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –í–≤–µ–¥–µ–Ω–∏–µ
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro1block/intro1.html">
   üü¶ –û –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –∫–æ–º–ø—å—é—Ç–µ—Ä–∞—Ö
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../prerequisite.html">
   ‚¨ú –ü—Ä–µ—Ä–µ–∫–≤–∏–∑–∏—Ç—ã –∫—É—Ä—Å–∞
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –û—Å–Ω–æ–≤—ã Python
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../pythonblock/pythonintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pythonblock/python_l1.html">
   üü¶ –í–≤–æ–¥–Ω–∞—è –ª–µ–∫—Ü–∏—è –ø—Ä–æ Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pythonblock/python_l2.html">
   üü¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pythonblock/python_l3.html">
   üü¶ –û—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è –≤ Jupyter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pythonblock/python_l4.html">
   üü¶ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, —Ç–∏–ø—ã –∏ –≤—ã–≤–æ–¥
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pythonblock/python_l5.html">
   üü¶ –£—Å–ª–æ–≤–∏—è –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pythonblock/python_l6.html">
   üü¶ –°–ø–∏—Å–∫–∏ –∏ —Ü–∏–∫–ª—ã
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pythonblock/python_l7.html">
   üü¶ –°–ª–æ–≤–∞—Ä–∏
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pythonblock/python_l8.html">
   üü¶ –§—É–Ω–∫—Ü–∏–∏
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pythonblock/python_l9.html">
   üü¶ –û–±—ä–µ–∫—Ç—ã –∏ –∫–ª–∞—Å—Å—ã
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../pythonblock/python_l10.html">
   üü¶ –§–∏–Ω–∞–ª—å–Ω–∞—è –ª–µ–∫—Ü–∏—è
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –õ–∏–Ω–µ–π–Ω–∞—è –∞–ª–≥–µ–±—Ä–∞ –∏ numpy
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../linalgblock/intro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../linalgblock/vectors.html">
   üü¶ –í–µ–∫—Ç–æ—Ä—ã
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../linalgblock/bra-ket.html">
   üü¶ –ù–æ—Ç–∞—Ü–∏—è –î–∏—Ä–∞–∫–∞
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../linalgblock/matrices.html">
   üü¶ –ú–∞—Ç—Ä–∏—Ü—ã
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../linalgblock/numpy.html">
   üü¶ Numpy fun
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –û—Å–Ω–æ–≤—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../mlblock/ml_intro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mlblock/ml_l1.html">
   üü¶ –ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –∫–∞–∫ –ø–∞–∑–ª
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –ö–≤–∞–Ω—Ç–æ–≤—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../qcblock/qcintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qcblock/qubit.html">
   üü© –ö–≤–∞–Ω—Ç–æ–≤—ã–π –±–∏—Ç
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qcblock/gates.html">
   üü© –ö–≤–∞–Ω—Ç–æ–≤—ã–µ –≥–µ–π—Ç—ã
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qcblock/mixedstates.html">
   üü® –°–º–µ—à–∞–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –§—Ä–µ–π–º–≤–æ—Ä–∫–∏
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../progblock/progintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../progblock/progreview.html">
   üü© –û–±–∑–æ—Ä —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../progblock/pennylane.html">
   üü© PennyLane
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../progblock/cirq_tfq.html">
   üüß Cirq &amp; TFQ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../progblock/qiskit.html">
   üüß Qiskit
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –ë–∞–∑–æ–≤—ã–µ –∫–≤–∞–Ω—Ç–æ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../qcalgo/qcalgointro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qcalgo/quantum_algorithms_overview.html">
   üü© –û–±–∑–æ—Ä –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qcalgo/deutschs_algorithm.html">
   üü© –ê–ª–≥–æ—Ä–∏—Ç–º –î–æ–π—á–∞
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qcalgo/quantum_teleportation.html">
   üü© –ö–≤–∞–Ω—Ç–æ–≤–∞—è —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏—è
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qcalgo/superdense_coding.html">
   üü© –°–≤–µ—Ä—Ö–ø–ª–æ—Ç–Ω–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qcalgo/grovers_algorithm.html">
   üüß –ê–ª–≥–æ—Ä–∏—Ç–º –ì—Ä–æ–≤–µ—Ä–∞
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qcalgo/simon_algorithm.html">
   üüß –ê–ª–≥–æ—Ä–∏—Ç–º –°–∞–π–º–æ–Ω–∞
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –ñ–µ–ª–µ–∑–æ –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../hwblock/hwintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../hwblock/hwreview.html">
   üü© –û–±–∑–æ—Ä
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../hwblock/scqubits.html">
   üü• –°–≤–µ—Ä—Ö–ø—Ä–æ–≤–æ–¥–Ω–∏–∫–æ–≤—ã–µ –∫—É–±–∏—Ç—ã
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –ö–≤–∞–Ω—Ç–æ–≤–æ–µ –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../qmlkindsblock/qmlkindsintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qmlkindsblock/qmlkinds.html">
   üü¶ –í–∏–¥—ã QML
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qmlkindsblock/hhl_algorithm.html">
   üü• –ê–ª–≥–æ—Ä–∏—Ç–º HHL
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qmlkindsblock/qknn.html">
   üü• –ê–ª–≥–æ—Ä–∏—Ç–º QKNN
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –í–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å—Ö–µ–º—ã
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../vqcblock/vqcintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../vqcblock/vqc.html">
   üü© –í–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å—Ö–µ–º—ã
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –ö–≤–∞–Ω—Ç–æ–≤—ã–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../gradsblock/gradsintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../gradsblock/gradients.html">
   üü© –ì—Ä–∞–¥–∏–µ–Ω—Ç—ã –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö —Å—Ö–µ–º
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../gradsblock/hogradients.html">
   üüß –ì—Ä–∞–¥–∏–µ–Ω—Ç—ã –≤—ã—Å—à–∏—Ö –ø–æ—Ä—è–¥–∫–æ–≤
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –ö–≤–∞–Ω—Ç–æ–≤—ã–π SVM
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../qsvmblock/qsvmintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qsvmblock/hybridsvm.html">
   üü© –ì–∏–±—Ä–∏–¥–Ω—ã–π SVM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qsvmblock/classic_svm.html">
   üüß –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π SVM
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –ö–≤–∞–Ω—Ç–æ–≤—ã–µ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="qnnintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="qnn.html">
   üü© –ö–≤–∞–Ω—Ç–æ–≤—ã–µ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="qconv.html">
   üü© –ö–≤–∞–Ω—Ç–æ–≤—ã–µ —Å–≤–µ—Ä—Ç–æ—á–Ω—ã–µ —Å–µ—Ç–∏
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Barren Plateau
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –ü—Ä–æ–±–ª–µ–º—ã –∫–≤–∞–Ω—Ç–æ–≤–æ–≥–æ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../problemsblock/problemsintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../problemsblock/quantchembasic.html">
   üü© –ö–≤–∞–Ω—Ç–æ–≤–∞—è —Ö–∏–º–∏—è (–í–≤–µ–¥–µ–Ω–∏–µ)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../problemsblock/quantchemadvancedscf.html">
   üüß –ö–≤–∞–Ω—Ç–æ–≤–∞—è —Ö–∏–º–∏—è (SCF)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../problemsblock/ising.html">
   üü© –ú–æ–¥–µ–ª—å –ò–∑–∏–Ω–≥–∞
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../problemsblock/advising.html">
   üüß –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –º–æ–¥–µ–ª—å –ò–∑–∏–Ω–≥–∞
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../problemsblock/copt.html">
   üü© –ö–æ–º–±–∏–Ω–∞—Ç–æ—Ä–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –û—Ç –ø—Ä–æ–±–ª–µ–º –∫ –æ–±—É—á–µ–Ω–∏—é
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../problems2qml/problems2qmlintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../problems2qml/np2ising.html">
   üü© NP –∫–∞–∫ –º–æ–¥–µ–ª–∏ –ò–∑–∏–Ω–≥–∞
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../problems2qml/jordanwigner.html">
   üüß –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ñ–æ—Ä–¥–∞–Ω–∞-–í–∏–≥–Ω–µ—Ä–∞
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../problems2qml/eigenvals.html">
   üü© –û —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  VQE
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../vqeblock/vqeintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../vqeblock/vqe.html">
   üü© –û—Å–Ω–æ–≤—ã VQE
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../vqeblock/tspvqe.html">
   üüß VQE - –ø—Ä–∞–∫—Ç–∏–∫–∞
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  D-Wave ‚Äì –∫–≤–∞–Ω—Ç–æ–≤—ã–π –æ—Ç–∂–∏–≥ –∏ —Å–µ–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../dwaveblock/dwaveintro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dwaveblock/dwave.html">
   üü© –ö–≤–∞–Ω—Ç–æ–≤—ã–π –æ—Ç–∂–∏–≥ –∏ —Å–µ–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dwaveblock/annealing_paper_1998.html">
   üüß –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–≤–∞–Ω—Ç–æ–≤–æ–π –∏ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π –∏–º–∏—Ç–∞—Ü–∏–∏ –æ—Ç–∂–∏–≥–∞
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  QAOA
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../qaoablock/intro.html">
   ‚¨ú –û –±–ª–æ–∫–µ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qaoablock/qaoa.html">
   üü© QAOA
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –ü–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../perspectives/academic_industrial.html">
   ‚¨ú –ê–∫–∞–¥–µ–º–∏—è –∏ –∏–Ω–¥—É—Å—Ç—Ä–∏—è
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  –û –∫—É—Ä—Å–µ
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../bibliography.html">
   –°–ø–∏—Å–æ–∫ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../authors.html">
   –°–ø–∏—Å–æ–∫ –∞–≤—Ç–æ—Ä–æ–≤ –∫—É—Ä—Å–∞
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../glossary.html">
   –ì–ª–æ—Å—Å–∞—Ä–∏–π
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../acknowledgments.html">
   –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../leaderboard.html">
   –†–µ–π—Ç–∏–Ω–≥
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../../_sources/book/qnnblock/barrenplateau.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/book/qnnblock/barrenplateau.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/quantum-ods/qmlcourse"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/quantum-ods/qmlcourse/issues/new?title=Issue%20on%20page%20%2Fbook/qnnblock/barrenplateau.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/quantum-ods/qmlcourse/master?urlpath=tree/qmlcourseRU/book/qnnblock/barrenplateau.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#description-of-the-lecture">
   Description of the lecture
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-is-a-barren-plateau">
   What is a barren plateau?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#when-do-we-have-barren-plateaus">
   When do we have barren plateaus?
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#when-the-circuit-distribution-is-a-2-design">
     When the circuit distribution is a 2-design
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#haar-measure-and-2-designs">
       Haar measure and 2-designs
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#designs-and-barren-plateaus">
       2-designs and barren plateaus
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#when-the-number-of-layers-is-high">
     When the number of layers is high
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#when-the-cost-function-is-global">
     When the cost function is global
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#when-noise-is-present">
     When noise is present
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#when-hidden-and-visible-layers-of-qnns-are-highly-entangled">
     When hidden and visible layers of QNNs are highly entangled
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-to-mitigate-the-barren-plateau-phenomenon">
   How to mitigate the barren plateau phenomenon?
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#global-to-local-cost-function">
     Global to local cost function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#architectures-with-a-logarithmic-number-of-layers">
     Architectures with a logarithmic number of layers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#correlated-parameters">
     Correlated parameters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#training-strategies">
     Training strategies
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#initialization-strategies">
     Initialization strategies
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#error-mitigation-against-noise-induced-barren-plateau">
     Error mitigation against noise-induced barren plateau
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#landscape-of-variational-circuits">
   Landscape of variational circuits
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#barren-plateaus-and-narrow-gorges">
     Barren plateaus and narrow gorges
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#could-better-optimizers-help-navigate-the-landscape">
     Could better optimizers help navigate the landscape?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#expressibility-vs-trainability">
     Expressibility vs trainability
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conclusion">
   Conclusion
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#resources">
   Resources
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#appendix-the-maths-of-barren-plateaus">
   Appendix: the maths of barren plateaus
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#computing-gradients">
     Computing gradients
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#computing-expectations-weingarten-calculus">
     Computing expectations: Weingarten calculus
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="the-barren-plateau-phenomenon">
<h1>The barren plateau phenomenon<a class="headerlink" href="#the-barren-plateau-phenomenon" title="Permalink to this headline">¬∂</a></h1>
<div class="section" id="description-of-the-lecture">
<h2>Description of the lecture<a class="headerlink" href="#description-of-the-lecture" title="Permalink to this headline">¬∂</a></h2>
<p>In this lecture, we will learn about the barren plateau phenomenon. It is a common pittfall of many VQC architectures, for which an exponentially vanishing gradient hinders the optimization process. In particular, we will try to answer the following questions:</p>
<ul class="simple">
<li><p>What is the barren plateau phenomenon?</p></li>
<li><p>Under which conditions can barren plateaus occur?</p></li>
<li><p>What strategies can we adopt to avoid them?</p></li>
</ul>
</div>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¬∂</a></h2>
<p>Variational algorithms have emerged as a central class of quantum algorithms for NISQ devices. They can be used to solve a large variety of problems, from finding the ground-state of a Hamiltonian in quantum chemistry, material science or combinatorial optimization to solving machine learning problems with quantum neural networks. However, the elephant in the room is that we basically don‚Äôt know if they can solve problems that classical computers couldn‚Äôt solve as efficiently. Indeed, variational algorithms can be victim of two kinds of issues:</p>
<ul class="simple">
<li><p><strong>Low-expressiveness</strong>: the variational circuit cannot efficiently represent the states or functions of interest. For instance, a ansatz for VQE might need an exponential number of gates/layers to be able to approximate the ground state of interesting Hamiltonians (i.e. Hamiltonians that cannot be efficiently simulated with classical tensor network or Monte Carlo techniques).</p></li>
<li><p><strong>Bad trainability</strong>: it takes an exponential time (or an exponential precision in the measurement process) to find the correct parameters of the variational ansatz.</p></li>
</ul>
<p>Trainability is the topic of today. What do we know about the optimization of variational circuits that could make them less trainable than, let‚Äôs say, regular neural networks? This question was studied for the first time by a <a class="reference external" href="https://arxiv.org/abs/1803.11173">team at Google</a> who introduced the main tool to study this question, namely the <strong>barren plateau phenomenon</strong>. Such phenomenon occurs whenever the gradient of a randomly-initialized parametrized quantum circuit gets exponentially close to <span class="math notranslate nohighlight">\(0\)</span> when increasing the number of qubits. The presence of small gradients tends to make the optimization problem extremely difficult for large systems, as it means that the landscape of the function we want to optimize is mostly flat, or <em>barren</em>. Finding a good descent direction at each optimization step is therefore a laborious process. The presence or absence of barren plateaus is influenced by many aspects of variational architectures: the <a class="reference external" href="https://arxiv.org/abs/2011.02966">type of ansatz</a>, the <a class="reference external" href="https://arxiv.org/abs/2001.00550">number of layers</a>, the <a class="reference external" href="https://arxiv.org/abs/2001.00550">cost function</a>, the <a class="reference external" href="https://arxiv.org/abs/2007.14384">strength of noise</a> and <a class="reference external" href="https://arxiv.org/abs/2010.15968">entanglement</a>, the <a class="reference external" href="https://arxiv.org/abs/1903.05076">initialization strategy</a>, etc.</p>
<p>We will explore here those different features of barren plateaus, with the goal of helping you identify if any architecture you‚Äôre considering might exhibit this phenomenon. Let‚Äôs start by giving a more precise definition of barren plateaus and go through some simple examples.</p>
</div>
<div class="section" id="what-is-a-barren-plateau">
<h2>What is a barren plateau?<a class="headerlink" href="#what-is-a-barren-plateau" title="Permalink to this headline">¬∂</a></h2>
<blockquote>
<div><p><strong>Definition:</strong> a variational circuit on <span class="math notranslate nohighlight">\(n\)</span> qubits is said to have a <em>barren plateau phenomenon</em> if, when initialized randomly, the gradient of its cost function is concentrated around <span class="math notranslate nohighlight">\(0\)</span> with a variance that decreases exponentially with <span class="math notranslate nohighlight">\(n\)</span>.</p>
</div></blockquote>
<p>Let‚Äôs unwrap this definition. First of all, the barren plateau is a random phenomenon, meaning that it can only be quantified when considering a random distribution of variational parameters, and will strongly depend on the properties of this distribution. Whether gradients are still small in the middle of the optimization process is harder to prove. Secondly, the presence or absence of a barren plateau depends on both the ansatz and the cost-function. Changing the cost-function or the ansatz used to solve a given problem can therefore serve as a mitigation strategy to avoid barren plateaus. Finally, the barren plateau is an asymptotic phenomenon, and by convention only occurs when the gradient is <em>exponentially</em> decaying with the number of qubits. It is something important to notice as a polynomially-vanishing gradient could potentially destroy certain types of quantum advantage without being called barren plateau in the current terminology.</p>
<p>Hands-on code example here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">visualize_barren_plateau</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>So, why do we care about barren plateaus? Because the properties of the gradients have a large influence on the optimization process. Let‚Äôs imagine that you are optimizing your cost-function using gradient-descent. Then you need to compute the gradient at each step. If the gradient is exponentially close to zero, we will need an exponential precision to compute it, and that sucks. As we will see later, this issue can also arise when considering gradient-free methods, so the problem is not only about some particular gradient descent algorithms, but really about the landscape of the cost-function.</p>
</div>
<div class="section" id="when-do-we-have-barren-plateaus">
<h2>When do we have barren plateaus?<a class="headerlink" href="#when-do-we-have-barren-plateaus" title="Permalink to this headline">¬∂</a></h2>
<div class="section" id="when-the-circuit-distribution-is-a-2-design">
<h3>When the circuit distribution is a 2-design<a class="headerlink" href="#when-the-circuit-distribution-is-a-2-design" title="Permalink to this headline">¬∂</a></h3>
<p>[Insert figure with a big unitary matrix]</p>
<p>‚ÄúWhen the circuit distribution is a what?‚Äù. Let‚Äôs unravel those terms, which are crucial to understand the essence of barren plateaus.</p>
<div class="section" id="haar-measure-and-2-designs">
<h4>Haar measure and 2-designs<a class="headerlink" href="#haar-measure-and-2-designs" title="Permalink to this headline">¬∂</a></h4>
<p>Let‚Äôs say you have a certain parametrized quantum circuit.
It can be represented by a unitary matrix <span class="math notranslate nohighlight">\(U(\theta)\)</span> depending on some parameters <span class="math notranslate nohighlight">\(\theta\)</span>.
You then need to specify a distribution to initialize your circuit.
For instance, you could choose to pick your <span class="math notranslate nohighlight">\(\theta\)</span>s uniformly between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(2\pi\)</span>.
Or have a Gaussian distribution centered around <span class="math notranslate nohighlight">\(0\)</span>.
In any case, this distribution over the parameters will induce a distribution over unitary matrices:
each time you initialize your circuit, you get a different unitary <span class="math notranslate nohighlight">\(U\)</span> that has a certain probability density <span class="math notranslate nohighlight">\(p(U)\)</span>.
And we‚Äôre lucky, there is an entire field, called <em>random matrix theory</em>, that studies those distribution over matrices, and in particular over unitary matrices.
For example, in random matrix theory, the equivalent of the uniform distribution is called the <strong>Haar measure</strong>.
The Haar measure over the unitary group <span class="math notranslate nohighlight">\(\mathcal{U}(n)\)</span> is defined as the unique probability distribution <span class="math notranslate nohighlight">\(p_{\text{Haar}}\)</span> such that</p>
<p>\begin{equation}
\forall U, V \in \mathcal{U}(n), p_{\text{Haar}}(UV)=p_{\text{Haar}}(VU)=p_{\text{Haar}}(U)
\end{equation}</p>
<p>It means that moving around the unitary group does not change the density, or in other words, all unitary matrices have equal probability.
While algorithms exist to sample unitary matrices over the Haar distribution, most quantum circuit initialization schemes are based on parameter initialization and do not directly follow the Haar measure. However, they can often approximate it.</p>
<p>A particular type of approximation of the Haar measure is formed by the so-called <strong><span class="math notranslate nohighlight">\(t\)</span>-designs</strong>. A distribution <span class="math notranslate nohighlight">\(p\)</span> over the unitary group is a <span class="math notranslate nohighlight">\(t\)</span>-design if all its moments up to <span class="math notranslate nohighlight">\(t\)</span> (expectation, variance, etc.) are equal to those of the Haar measure. More formally, for any polynomial function <span class="math notranslate nohighlight">\(f\)</span> of degree <span class="math notranslate nohighlight">\(t\)</span>, we should have:</p>
<div class="math notranslate nohighlight">
\[
  \mathbb{E}_{U \sim p_{\text{Haar}}}[f(U)]=\mathbb{E}_{U \sim p}[f(U)]
\]</div>
<p>Sometimes, you‚Äôll also find in the literature the definition of a <span class="math notranslate nohighlight">\(t\)</span>-design written as</p>
<div class="math notranslate nohighlight">
\[
  \forall M, \, \int (U^{\dagger})^{\otimes t} M U^{\otimes t} dp(U) = \int (U^{\dagger})^{\otimes t} M U^{\otimes t} dp_{\text{Haar}}(U)
\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[
  \forall M, \, \frac{1}{N} \sum_k (U_k^{\dagger})^{\otimes t} M U_k^{\otimes t} = \int (U^{\dagger})^{\otimes t} M U^{\otimes t} dp_{\text{Haar}}(U)
\]</div>
<p>which is just the explicit form of the equation above, when the distribution is respectively continuous or discrete and <span class="math notranslate nohighlight">\(M\)</span> is the matrix representing the polynomial we want to take. In particular, <span class="math notranslate nohighlight">\(2\)</span>-designs are distributions that have the same expectation and variance as the Haar measure, and they appear everywhere in quantum information. For instance, if you construct a circuit by randomly inserting Clifford gates (H, CNOT, S), you‚Äôll eventually get a 2-design [TODO: make those statements more precise]</p>
</div>
<div class="section" id="designs-and-barren-plateaus">
<h4>2-designs and barren plateaus<a class="headerlink" href="#designs-and-barren-plateaus" title="Permalink to this headline">¬∂</a></h4>
<p>So what‚Äôs the link between 2-designs and barren plateaus? It happens that whenever your circuit distribution follows a 2-design, you‚Äôll get a barren plateau. That statement was proved in the <a class="reference external" href="https://arxiv.org/abs/1803.11173">first paper on barren plateau</a> and takes the following more precise form:</p>
<blockquote>
<div><p><strong>Theorem:</strong> let <span class="math notranslate nohighlight">\(U(\theta)\)</span> a parametrized quantum circuit, <span class="math notranslate nohighlight">\(U_k=e^{iA\theta_k}\)</span> a particular gate in the circuit, <span class="math notranslate nohighlight">\(\rho\)</span> the input density matrix and <span class="math notranslate nohighlight">\(E(\theta)=\text{Tr}[HU(\theta)\rho U^\dagger(\theta)]\)</span> the cost function we are trying to optimize. Then, if the unitaries before and after <span class="math notranslate nohighlight">\(U_k\)</span> follow a 2-design, we will have as the number of qubits <span class="math notranslate nohighlight">\(n \rightarrow \infty\)</span>:</p>
<div class="math notranslate nohighlight">
\[\mathbb{E}[\partial_k E]=0\]</div>
<div class="math notranslate nohighlight">
\[\text{Var}[\partial_k E] \sim - \frac{2}{2^{3n}} \text{Tr}[\rho^2] \text{Tr}[H^2] \text{Tr}[A^2]\]</div>
</div></blockquote>
<p>So in other words, randomly initializing a quantum circuit such that the resulting distribution is a 2-design will directly give you exponentially vanishing gradients. The trace terms appearing in the variance usually don‚Äôt contribute too much to the overall scaling. Indeed, taking VQE as an example, the intial density matrix is usually taken to be <span class="math notranslate nohighlight">\(\rho = |0\rangle \langle 0 |\)</span> for which <span class="math notranslate nohighlight">\(\text{Tr}[\rho^2]=1\)</span>. Gates are usually rotations, in which case <span class="math notranslate nohighlight">\(A\)</span> is a pauli matrix, fullfilling <span class="math notranslate nohighlight">\(\text{Tr}[A^2]=n\)</span>. Finally, if <span class="math notranslate nohighlight">\(H\)</span> is a sum of local terms (e.g. an Ising Hamiltonian), we can also show that <span class="math notranslate nohighlight">\(\text{Tr}[H^2]\)</span> won‚Äôt have any influence on the scaling.</p>
<!-- While proving this theorem is out-of-scope for this lecture, let's try to give some intuition using the notion of concentration of measure.

#### Concentration of measure -->
</div>
</div>
<div class="section" id="when-the-number-of-layers-is-high">
<h3>When the number of layers is high<a class="headerlink" href="#when-the-number-of-layers-is-high" title="Permalink to this headline">¬∂</a></h3>
<p>At this point of the lecture, you might be thinking that this 2-design assumption doesn‚Äôt help you much in knowing whether your particular variational architecture has a barren plateau or not. Indeed, how to know if your ansatz and initialization scheme give rise to a 2-design?</p>
<p>The first hint concerns the number of layers.
Indeed, a known procedure to create a 2-design is to build a circuit with a polynomial number of random 2-qubit gates. The precise nature of the polynomial depends on the dimension of the lattice underlying your qubits (considering that you can only put a gate between neighboring qubits). For a lattice of dimension <span class="math notranslate nohighlight">\(d\)</span>, having <span class="math notranslate nohighlight">\(O(n^{1/d})\)</span> random gates gives you an approximate 2-design (see <a class="reference external" href="https://arxiv.org/abs/1809.06957">Harrow and Mehraban, 2018</a>). So, while having a high-dimensional lattice is advantageous from an expressiveness perspective (you can build more circuits at a given depth), it will kill your gradients with a higher probability.</p>
<p>This statement was made rigorous in <a class="reference external" href="https://arxiv.org/abs/2001.00550">Cerezo et al, 2020</a>, for a particular type of 1D ansatz: the hardware-efficient ansatz (HEA), sometimes also called alternating layer ansatz. Here is a representation of the HEA, along with the scaling laws demonstrated in the paper:</p>
<p><img alt="Scaling of the hardware-efficient ansatz" src="../../_images/cost-dependent-bp.png" /></p>
<p>We can see that the ansatz is indeed one-dimensional: each qubit is only connected to two other qubits. Moreover, each layer is a depth-two circuit made of gates between all the neighboring qubits. The name ‚Äúhardware-efficient‚Äù comes from the combination of those two properties: 1D lattices can easily be realised on real hardware, and gates are efficiently lay out in the circuit.</p>
<p>In <a class="reference external" href="https://arxiv.org/abs/2001.00550">Cerezo et al, 2020</a>, the authors show that if each <span class="math notranslate nohighlight">\(2\)</span>-qubit unitary of the HEA follows a 2-design and if your cost function is local (more on that later), then you will <strong>not</strong> have any barren plateau if the number of layers grows as <span class="math notranslate nohighlight">\(O(log(n))\)</span> (where <span class="math notranslate nohighlight">\(n\)</span> is the number of qubits). On the other hand, you will have one if the number of layers grows as <span class="math notranslate nohighlight">\(O(poly(n))\)</span>. While those laws were only proven in the context of the HEA, they are likely to hold for other types of ansatzes.</p>
<p>So, are barren plateaus destroying all hopes of optimizing deep quantum circuits? Potentially not: correlating parameters in the circuit, for instance by having many gates sharing the same parameter, has been shown to be helpful in mitigating the phenomenon. Therefore, ansatzes such as QAOA might not exhibit any barren plateau. We will discuss that in more details when talking about mitigation strategies.</p>
</div>
<div class="section" id="when-the-cost-function-is-global">
<h3>When the cost function is global<a class="headerlink" href="#when-the-cost-function-is-global" title="Permalink to this headline">¬∂</a></h3>
<p>In the previous discussion, we assumed that the cost function was local. Let‚Äôs explain what we mean by that. In many variational algorithm, the cost function can be written as</p>
<div class="math notranslate nohighlight">
\[
f(\theta)=\text{Tr}[H \rho_{\theta}]
\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho_{\theta}\)</span> is the output of the quantum circuit (which depends on the gate parameters <span class="math notranslate nohighlight">\(\theta\)</span>). We say that the cost function is local if <span class="math notranslate nohighlight">\(H\)</span> can be written as a sum of ‚Äúlocal‚Äù terms, i.e. terms that only involve a constant number of qubits. For instance, the Ising model</p>
<div class="math notranslate nohighlight">
\[
H=\sum_{i,j} J_{ij} Z_i Z_j
\]</div>
<p>is local (since each term <span class="math notranslate nohighlight">\(Z_i Z_j\)</span> only involves two qubits), while a Hamiltonian like</p>
<div class="math notranslate nohighlight">
\[
H=Z^{\otimes n}
\]</div>
<p>is global.</p>
<p>A second result from the paper mentionned previously is that global cost functions can lead to barren plateaus for all circuit depths (including constant-depth):</p>
<p><img alt="Noise-Induced Barren Plateau" src="../../_images/global-cost-function.png" /></p>
<p>Where do global cost functions appear in variational algorithms? An important example is when maximizing the fidelity between the output of your circuit and a given reference state. For instance, imagine that you want to prepare a state <span class="math notranslate nohighlight">\(|\psi\rangle\)</span> at the end of your variational circuit. You can do that by maximizing the fidelity</p>
<div class="math notranslate nohighlight">
\[
F(\psi,\psi_{\theta}) = |\langle \psi | \psi_{\theta} \rangle|^2 = \text{Tr}[|\psi\rangle \langle \psi | \rho_{\theta}]
\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho_{\theta}=|\psi_{\theta}\rangle \langle \psi_{\theta} |\)</span> is the output of the circuit. This corresponds to minimizing the cost function corresponding to the ‚ÄúHamiltonian‚Äù:</p>
<div class="math notranslate nohighlight">
\[
H=-|\psi\rangle \langle \psi|
\]</div>
<p>which will often be a global cost function. For instance, if <span class="math notranslate nohighlight">\(|\psi\rangle\)</span> is the zero state, it can be written</p>
<div class="math notranslate nohighlight">
\[
H=-|0\rangle\langle 0|^{\otimes n},
\]</div>
<p>which involves all the qubits and is therefore global. We will see later how to turn this type of global cost functions into local ones, in order to mitigate the resulting barren plateau problem.</p>
</div>
<div class="section" id="when-noise-is-present">
<h3>When noise is present<a class="headerlink" href="#when-noise-is-present" title="Permalink to this headline">¬∂</a></h3>
<p>Barren plateaus can emerge from a completely different reason than random initialization: the presence of noise during the computation. In <a class="reference external" href="https://arxiv.org/abs/2007.14384">Wang et al.</a>, the authors show that a polynomial-depth circuit with local noise after each layer of unitary gates (as represented in the figure below) exhibit a barren plateau phenomenon.</p>
<p><img alt="Noise-Induced Barren Plateau" src="../../_images/nibp.png" /></p>
<p>Their model is very general and includes physically-motivated ansatzes such as QAOA and the Unitary Coupled Cluster ansatz (UCC). In particular, it means that some ansatzes which don‚Äôt a priori suffer from noise-free barren plateaus (such as QAOA) can actually get vanishing gradients due to noise. This reduces the prospect of training large variational circuits on near-term, non fault-tolerant devices.</p>
</div>
<div class="section" id="when-hidden-and-visible-layers-of-qnns-are-highly-entangled">
<h3>When hidden and visible layers of QNNs are highly entangled<a class="headerlink" href="#when-hidden-and-visible-layers-of-qnns-are-highly-entangled" title="Permalink to this headline">¬∂</a></h3>
<p>Specific to a particular QNN architecture as well as QRBM.</p>
</div>
</div>
<div class="section" id="how-to-mitigate-the-barren-plateau-phenomenon">
<h2>How to mitigate the barren plateau phenomenon?<a class="headerlink" href="#how-to-mitigate-the-barren-plateau-phenomenon" title="Permalink to this headline">¬∂</a></h2>
<div class="section" id="global-to-local-cost-function">
<h3>Global to local cost function<a class="headerlink" href="#global-to-local-cost-function" title="Permalink to this headline">¬∂</a></h3>
<p>Example of the fidelity.</p>
</div>
<div class="section" id="architectures-with-a-logarithmic-number-of-layers">
<h3>Architectures with a logarithmic number of layers<a class="headerlink" href="#architectures-with-a-logarithmic-number-of-layers" title="Permalink to this headline">¬∂</a></h3>
<p>While having a local cost-function is necessary to fight barren plateaus, it might not completely resolve it if your circuit is too deep. Therefore, looking at circuits with a logarithmic number of layers is a simple solution to mitigate the barren plateau effect. But which ansatzes naturally have a logarithmic number of layers? There is at least one that has gathered some tractions in the field, namely the <a class="reference external" href="https://arxiv.org/abs/1810.03787">quantum convolutional neural network (QCNN)</a>:</p>
<p><img alt="Noise-Induced Barren Plateau" src="../../_images/qcnn.png" /></p>
<p>This architecture is made to process quantum data, i.e. data that are given as quantum states coming from the output of a quantum experiment, such as a previous quantum algorithm or some quantum sensors. For instance, after having run a quantum algorithm computing the ground-state of a Hamiltonian, you might want to know some properties of this ground-state, such as its energy, the phase of matter it belongs to, etc. One way to obtain this information is to perform quantum state tomography, which will give you the full quantum state as a classical vector of dimension <span class="math notranslate nohighlight">\(2^n\)</span>, that you can then process classically. Another possibility is to run a quantum algorithm that directly outputs this property, such as a variational circuit trained to do so.
Machine learning on quantum data is a promising research direction, where a form of quantum advantage <a class="reference external" href="https://arxiv.org/abs/2112.00778">can be rigorously proven</a>.</p>
<p>QCNNs are models that take a state <span class="math notranslate nohighlight">\(\rho_{i}\)</span> as input and output a target number <span class="math notranslate nohighlight">\(\hat{y}\)</span>, that can for instance represent the phase of matter <span class="math notranslate nohighlight">\(\rho_{\text{in}}\)</span> belongs to (e.g. ferromagnetic if <span class="math notranslate nohighlight">\(\hat{y} = 0\)</span> vs paramagnetic if <span class="math notranslate nohighlight">\(\hat{y}=1\)</span>). The ansatz is made of a succession of ‚Äúconvolutional blocks‚Äù and ‚Äúpooling blocks‚Äù. Each convolutional block consists in a 1D arrangement of two-qubit unitaries, similar to the hardware-efficient ansatz. However, all the unitaries of a given block share the same parameters, making the whole block translationally invariant. The name <em>convolutional</em> comes precisely from the fact that convolutions can be defined as operations having a translational symmetry (see this <a class="reference external" href="https://towardsdatascience.com/deriving-convolution-from-first-principles-4ff124888028">amazing blog post</a> by Michael Bronstein for more details). Each convolutional block is followed by a ‚Äúpooling layer‚Äù (by analogy with the classical CNN jargon), where conditional measurements are performed to reduce the dimensionality of the state.</p>
<p>As a consequence, the total depth of the QCNN is logarithmic, and we can therefore expect an absence of barren plateaus. This was proven more rigorously in <a class="reference external" href="https://arxiv.org/abs/2011.02966">Pesah et al.</a>: the gradient is at least greater than <span class="math notranslate nohighlight">\(O\left(\frac{1}{n^{\alpha}}\right)\)</span> with <span class="math notranslate nohighlight">\(\alpha &gt; 0\)</span>, so there is no exponential vanishing.</p>
<p>While discovering a quantum advantage for QCNNS is still an open problem, we at least known that training shouldn‚Äôt be the main issue to make this architecture work.</p>
</div>
<div class="section" id="correlated-parameters">
<h3>Correlated parameters<a class="headerlink" href="#correlated-parameters" title="Permalink to this headline">¬∂</a></h3>
<p>Example of QAOA</p>
</div>
<div class="section" id="training-strategies">
<h3>Training strategies<a class="headerlink" href="#training-strategies" title="Permalink to this headline">¬∂</a></h3>
<p><a class="reference external" href="https://arxiv.org/abs/2006.14904">Layerwise learning for quantum neural networks</a></p>
<p>Natural gradient and hessian methods: in <a class="reference external" href="https://arxiv.org/abs/2008.02785">Huembeli et al.</a>, it was shown that two techniques, natural gradient descent and learning rate adapation using the Hessian matrix, lead to an improve convergence time. It was then argued that the reason was probably a mitigated barren plateau effect.</p>
</div>
<div class="section" id="initialization-strategies">
<h3>Initialization strategies<a class="headerlink" href="#initialization-strategies" title="Permalink to this headline">¬∂</a></h3>
<p>Paper by UCL team. However, unlikely to really help, see next section.</p>
</div>
<div class="section" id="error-mitigation-against-noise-induced-barren-plateau">
<h3>Error mitigation against noise-induced barren plateau<a class="headerlink" href="#error-mitigation-against-noise-induced-barren-plateau" title="Permalink to this headline">¬∂</a></h3>
</div>
</div>
<div class="section" id="landscape-of-variational-circuits">
<h2>Landscape of variational circuits<a class="headerlink" href="#landscape-of-variational-circuits" title="Permalink to this headline">¬∂</a></h2>
<p>Is there any hope of finding better gradients by initializing circuits differently, or choosing different optimizers than gradient descent?
Unfortunately, evidence seem to converge to a negative answer: the barren plateau phenomenon is not fundamentally about random gradients or 2-designs, it is about the optimization landscape of variational circuits. If the gradient of random circuits is exponentially small with a high probability, it means that a significant part of the landscape is basically flat. It implies that whatever optimization method you choose (gradient-free, second-order, etc.), you will have a hard time navigate the landscape towards a global minimum. It also means that the only initialization strategies that are likely to help are the ones that already bring you very close to a global minimum, but finding such strategy might be as hard as finding the minimum itself. This idea that flat landscapes are the essence of barren plateau was made more precise in a series of papers that we will discuss now.</p>
<div class="section" id="barren-plateaus-and-narrow-gorges">
<h3>Barren plateaus and narrow gorges<a class="headerlink" href="#barren-plateaus-and-narrow-gorges" title="Permalink to this headline">¬∂</a></h3>
<p><a class="reference external" href="https://arxiv.org/abs/2104.05868">Paper</a></p>
</div>
<div class="section" id="could-better-optimizers-help-navigate-the-landscape">
<h3>Could better optimizers help navigate the landscape?<a class="headerlink" href="#could-better-optimizers-help-navigate-the-landscape" title="Permalink to this headline">¬∂</a></h3>
<p>When reading about barren plateaus, something might have crossed your mind: if the barren plateau problem is mostly related to the magnitude of the gradient, why not using an other type of optimization technique that don‚Äôt rely directly or uniquely on the gradient. For instance, optimizers such as Nelder-Mead don‚Äôt require any gradient information. Moreover, some optimizers discussed previously such as quantum natural gradient descent and hessian-based methods are rescaling the gradient and could therefore in principle improve its scaling.</p>
<p>While those techniques might have an effect on small systems, it is unlikely that they will change the overall scaling of the problem, as shown in a <a class="reference external" href="https://arxiv.org/pdf/2008.07454.pdf">recent paper</a>.</p>
</div>
<div class="section" id="expressibility-vs-trainability">
<h3>Expressibility vs trainability<a class="headerlink" href="#expressibility-vs-trainability" title="Permalink to this headline">¬∂</a></h3>
<p><a class="reference external" href="https://arxiv.org/abs/2101.02138">Paper</a></p>
</div>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¬∂</a></h2>
<p>Barren plateau is only a scalability problem, showing that exponential advantage might be hard to obtain in the NISQ era with variational circuits. However, when working on practical problems, techniques can be used to mitigate its effects, and all hope is not gone that variaitonal circuits can lead to useful applications in the near-term.</p>
</div>
<div class="section" id="resources">
<h2>Resources<a class="headerlink" href="#resources" title="Permalink to this headline">¬∂</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://pennylane.ai/qml/demos/tutorial_barren_plateaus.html">Pennylane tutorial on barren plateaus</a></p></li>
<li><p><a class="reference external" href="https://pennylane.ai/qml/demos/tutorial_haar_measure.html">Pennylane tutorial on the Haar measure</a></p></li>
<li><p><a class="reference external" href="https://glassnotes.github.io/OliviaDiMatteo_Unitary2Designs.pdf">A short introduction to unitary t-designs</a></p></li>
</ul>
</div>
<div class="section" id="appendix-the-maths-of-barren-plateaus">
<h2>Appendix: the maths of barren plateaus<a class="headerlink" href="#appendix-the-maths-of-barren-plateaus" title="Permalink to this headline">¬∂</a></h2>
<div class="section" id="computing-gradients">
<h3>Computing gradients<a class="headerlink" href="#computing-gradients" title="Permalink to this headline">¬∂</a></h3>
</div>
<div class="section" id="computing-expectations-weingarten-calculus">
<h3>Computing expectations: Weingarten calculus<a class="headerlink" href="#computing-expectations-weingarten-calculus" title="Permalink to this headline">¬∂</a></h3>
<p>Hands-on example with RTNI in Python.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./book/qnnblock"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="qconv.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">–°–≤–µ—Ä—Ç–æ—á–Ω—ã–µ –≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω—ã–µ –∫–≤–∞–Ω—Ç–æ–≤—ã–µ —Å—Ö–µ–º—ã</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="../problemsblock/problemsintro.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">–û –±–ª–æ–∫–µ ‚Äú–ü—Ä–æ–±–ª–µ–º—ã –∫–≤–∞–Ω—Ç–æ–≤–æ–≥–æ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è‚Äù</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By ODS Quantum Community<br/>
        
            &copy; Copyright 2022.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-51362752-1', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>

  </body>
</html>