(matrices)=
# Матрицы

## Определение

Матрица - это математический объект, представляющий собой прямоугольную таблицу чисел.

У каждой матрицы есть размер, который характеризуется двумя числами - количеством строк и количеством столбцов. Матрицу, состоящую из $n$ строк $m$ столбцов будем называть матрицей размера $n \times m$. Пространство вещественных матриц $n \times m$ обозначается $\reals^{n \times m}$. Мы можем и будем рассматривать матрицу либо как набор $n$ вектор-строк, либо как набор $m$ вектор-столбцов.

**Замечание**: Вектор-строку из $n$ элементов можно рассматривать как матрицу размера $1 \times n$, а аналогичного размера вектор-столбец - как матрицу размера $n \times 1$.

Рассмотрим произвольную матрицу $\mathbf{A}$:
$$
\begin{pmatrix} a_{11} & a_{12} & ... & a_{1m} \\ a_{21} & a_{22} & ... & a_{2m} \\ ... & ... & ... & ... \\ a_{n1} & a_{n2} & ... & a_{nm} \end{pmatrix}
$$

Элемент матрицы $\mathbf{A}$, стоящий на пересечение строки $i$ и столбца $j$ будем обозначать $a_{ij}$.

В машинном обучении часто приходится иметь дело с матрицей объекты-признаки. Объекты, как и признаки - это набор числовых характеристик (точки в многомерном пространстве), которые обычно рассматриваются как векторы.

## Операции с матрицами

Аналогично векторным операциям, для матриц определены операции **сложения** и **умножения на число**:

- сложение:
$$
\begin{pmatrix} a_{11} & a_{12} & ... & a_{1m} \\ a_{21} & a_{22} & ... & a_{2m} \\ ... & ... & ... & ... \\ a_{n1} & a_{n2} & ... & a_{nm} \end{pmatrix} + \begin{pmatrix} b_{11} & b_{12} & ... & b_{1m} \\ b_{21} & b_{22} & ... & b_{2m} \\ ... & ... & ... & ... \\ b_{n1} & b_{n2} & ... & b_{nm} \end{pmatrix} = \begin{pmatrix} a_{11} + b_{11} & a_{12} + b_{12} & ... & a_{1m} + b_{1m} \\ a_{21} + b_{21} & a_{22} + b_{22} & ... & a_{2m} + b_{2m} \\ ... & ... & ... & ... \\ a_{n1} + b_{n1} & a_{n2} + b_{n2} & ... & a_{nm} + b_{nm} \end{pmatrix}
$$

- умножения матрицы на число (скаляр):
$$
\lambda \cdot \begin{pmatrix} a_{11} & a_{12} & ... & a_{1m} \\ a_{21} & a_{22} & ... & a_{2m} \\ ... & ... & ... & ... \\ a_{n1} & a_{n2} & ... & a_{nm} \end{pmatrix} = \begin{pmatrix} \lambda \cdot a_{11} & \lambda \cdot a_{12} & ... & \lambda \cdot a_{1m} \\ \lambda \cdot a_{21} & \lambda \cdot a_{22} & ... & \lambda \cdot a_{2m} \\ ... & ... & ... & ... \\ \lambda \cdot a_{n1} & \lambda \cdot a_{n2} & ... & \lambda \cdot a_{nm} \end{pmatrix}
$$

Но наибольший интерес представляет операция умножения матриц, которая определяется не самым интуитивным способом.

Рассмотрим операцию скалярного произведения как умножение матрицы размера $1 \times n$ (вектор-строка) на матрицу размера $n \times 1$ (вектор-столбец). Результатом данной операции получается матрица размера $1 \times 1$ (скаляр).

Таким образом для получения значения $c_{11}$ результирующей матрицы $\mathbf{С}$ мы скалярно умножили 1-ю строку $\mathbf{a_{1:}}$ матрицы $\mathbf{A}$ (вектор) на 1-ый столбец $\mathbf{b_{:1}}$ матрицы $\mathbf{B}$ (вектор).

Из примере выше мы можем прийти к следующим заключениям:
- для умножения матриц необходимо, чтобы количество столбцов первой матрицы было равно количеству строк второй, иначе нельзя посчитать скалярное произведение
- операция умножения матриц не является коммутативной, то есть $\mathbf{A} \mathbf{B} \not = \mathbf{B} \mathbf{A}$

Развивая логику примера выше мы можем перейти к определению операции умножения матриц. Рассмотрим матрицы $\mathbf{A} \in \reals^{n \times p}$ и $\mathbf{B} \in \reals^{p \times m}$. Результатом произведения этих матриц будем матрица $\mathbf{A} \mathbf{B} = \mathbf{C} \in \reals^{n \times m}$, где значение $c_{ij}$ получится путем скалярного произведения $i$-й строки $\mathbf{a_{i:}}$ матрицы $\mathbf{A}$ (вектор) на $j$-й столбец $\mathbf{b_{:j}}$ матрицы $\mathbf{B}$ (вектор):
$$
c_{ij} = \mathbf{a_{i:}} \cdot \mathbf{b_{:j}} = a_{i1}  b_{1j} + a_{i2}  b_{2j} + ... + a_{ip} b_{pj}
$$

**Замечание 1**: В результате умножения квадратных матриц размера $n \times n$ получается квадратная матрица того же размера.

**Замечание 2**: Частными случаями матричного умножения являются операции умножения вектор-строки на матрицу и матрицы на вектор-столбец, в результате которых получаются вектор-строка и вектор-столбец соответственно.

Рассмотрим пример, почему удобно представлять операцию умножения матриц именно таким образом. Пусть имеется система линейных уравнений:
$$
\begin{cases}
    a_{11} x_{1} + a_{12} x_{2} + ... + a_{1m} x_{m} = b_{1} \\
    a_{21} x_{1} + a_{22} x_{2} + ... + a_{2m} x_{m} = b_{2} \\
    ... \\
    a_{n1} x_{1} + a_{n2} x_{2} + ... + a_{nm} x_{m} = b_{n}
\end{cases}
$$

Данную система можно представить в матричном виде следующим образом:
$$
\mathbf{A} \mathbf{x} = \mathbf{b} \rightarrow \begin{pmatrix} a_{11} & a_{12} & ... & a_{1m} \\ a_{21} & a_{22} & ... & a_{2m} \\ ... & ... & ... & ... \\ a_{n1} & a_{n2} & ... & a_{nm} \end{pmatrix} \begin{pmatrix} x_{1} \\ x_{2} \\ ... \\ x_{n} \end{pmatrix} = \begin{pmatrix} b_{1} \\ b_{2} \\ ... \\ b_{n} \end{pmatrix}
$$

## Норма матрицы

Понятие нормы для матриц определяется тем же образом, что и для векторов. Существует множество матричных норм, но наиболее распространенной является **Евклидова норма**, она же **норма Фробениуса**:
$$
\lVert \mathbf{A} \rVert_{2} = \lVert \mathbf{A} \rVert_{F} = \sqrt{\sum_{i}\sum_{j}a_{ij}^2}
$$

## Ранг матрицы

Вспомним, что матрицу можно рассматривать либо как набор вектор-строк, либо как набор вектор-столбцов, а для набор векторов определенно понятие линейной независимости.

Таким образом мы приходим двум следующим понятиям:
- **строчный ранг** матрицы - это максимальное число линейно независимых строк (вектор-строк)
- **столбцовый ранг** матрицы - это максимальное число линейно независимых столбцов (вектор-столбцов)

Тут мы можем задаться вопрос о том, равны ли эти ранги между собой, и если равны, то при каких условиях, и на помощь нам приходит **фундаментальная теорема «о ранге матрицы»**, которая говорит, что ранг, посчитанный по строкам всегда равен рангу, посчитанному по столбцам. Поэтому обычно говорят просто о ранге матрицы.

## Линейные отображения и преобразования

В рамках школьной математики все знакомы с понятием функции. Функция - это соответствием между элементами двух множеств.

Например, линейная функция вида $y = f(x) = kx + b$ отображает элементы множества вещественных чисел $x \in \reals$ в себя $y \in \reals$ :
$$
f: \reals \rightarrow \reals
$$

Парабола $y = f(x) = x^2$ отображает элементы множества вещественных чисел $x \in \reals$ во множество неотрицательных вещественных чисел $y \in \reals^{+} \cup \{0\}$ :
$$
f: \reals \rightarrow \reals^{+} \cup \{0\}
$$

Среди всего множества функций есть определенный класс функций, называемых линейными. Этот класс является самым простым среди множества всех функций. Основным свойством линейных функций является пропорциональность $x$ и $y$: изменение значения функции $y$ пропорционально изменению значения аргумента $x$. Графиком линейной функции является прямая.

Обобщая идею линейных функций на матрицы и вектора мы можем прийти к понятиям **линейных отображений** и **линейных преобразований**.

Линейное отображение - это обобщение линейной функции, которое принимает на вход вектор и возвращает вектор. Вектор может быть как той же размерности, так и другой.

Формально, линейное отображение - это отображение множества элементов одного векторного пространства $V$ в другое $W$
$$
f: V \rightarrow W ,
$$
удовлетворяющее так называемым [условиям линейности](https://ru.wikipedia.org/wiki/Линейное_отображение#cite_note-_5e0d87b5e4a6def2-2).

Если $V$ и $W$ — это одно и то же векторное пространство, то
$f$ называют не просто линейным отображением, а **линейным преобразованием**.

Отображения и преобразования удобно рассматривать как движение в векторном пространстве.

```{figure} /_static/linalgblock/vector-transformation.png
:name: vector-meme
:width: 600px
```

Ранее упоминалось, что при умножении вектора на матрицу мы получаем вектор, поэтому матрица задает преобразование, которое, если проверить условия линейности, является линейным. Соответственно, **матрица задает линейное отображение**.

Например, матрица $\mathbf{A} \in \reals^{n \times m}$ задает преобразование из векторного пространства размерности $n$ в векторное пространство размерности $m$.

**Замечание 1**: Для того, чтобы матрица задавала линейное преобразование, она должна быть квадратной, т.к. в результате умножение вектора на квадратную матрицу его размерность не меняется. Таким образом вектор, как элемент векторного пространства, отображается в то же векторное пространство.

**Замечание 2**: Пусть имеются две матрицы $\mathbf{A} \in \reals^{n \times p}$ и $\mathbf{B} \in \reals^{p \times m}$. Умножив матрицу $\mathbf{A}$ на матрицу $\mathbf{B}$ мы получим матрицу $\mathbf{C} \in \reals^{n \times m}$. Матрица $\mathbf{C}$ задает линейное отображение, равное последовательному применению отображений, задаваемых матрицами $\mathbf{A}$ и $\mathbf{B}$. Таким образом операция умножения матриц имеет простую интерпретацию - последовательное применение линейных отображений.
