---
jupytext:
  formats: md:myst
  text_representation:
    extension: .md
    format_name: myst
kernelspec:
  display_name: Python 3
  language: python
  name: python3
---

(python_l10)=

# Финальная лекция обо всем и ни о чем

## Описание лекции
В этой лекции будет:
- рассказ о типовых ошибках при прохождении курса;
- разбор примеров кода из курса;
- дополнение для самых любознательных о `Python`, ML и вообще.

## Заметки по прохождению курса
В предыдущих лекциях по `Python` было много материала с примерами и дополнительными темами для самостоятельного изучения, но это все еще малая доля того, что нужно будет изучить для развития в теме ML/QML. Неизбежная часть обучения -- проблемы и ошибки. Если вы попытались разобраться с чем-либо, но у вас не получилось, приходите к нам в [сообщество в Slack](https://ods.ai/join-community), задавайте вопросы. Не забывайте помогать другим студентам: если материал или тема дались вам легко, то кому-то они могут показаться очень сложными.

Абсолютное большинство возникающих ошибок в `Python` не уникально и, скорее всего, вы не первый, кто наступил на эти грабли. Ищите решение в поисковике, но перед этим обязательно прочитайте текст ошибки, попробуйте осознать, о чем `Python` хочет вам сказать: в этом языке программирования одни из самых понятных и доступных подсказок и указателей на проблемы. К примеру, `IndexError: list index out of range` явно говорит о том, что во время обращения к i-тому объекту некоторого списка (который, кстати, будет указан в так называемом трейсбеке, от англ. traceback) возник выход за границы `list`. Возьмем для примера список `sample_list` чисел длины 5. Что произойдет, если обратиться к седьмому объекту `sample_list[7]`?

```{figure} /_static/pythonblock/python_l11/example_traceback.png
:name: example_traceback
:width: 550px

Получим ошибку.
```

Обратите внимание на стрелочку слева, указывающую на строку номер 5 (кстати, в Jupyter Notebook для каждой отдельной ячейки можно включить нумерацию строк для удобства навигации с помощью клавиши `l`). Это место возникновения ошибки -- та строка, на которой `Python` не смог выполнить инструкцию. Как можно решить проблему? Попробуйте разобраться, написано ли в коде то, что вы хотели. Например, может быть так, что вы копируете кусок кода (хотя нужно стараться избегать этого с помощью написания функций), но забываете поменять в нем переменные. Если все переменные объявлены верно и ошибка не ясна, то стоит заняться [отладкой кода](https://ru.wikipedia.org/wiki/Отладка_программы).

Самый простой способ отладки в Jupyter -- это расстановка `print`'ов до проблемной строки. Да-да, так кустарно и грубо. Есть более продвинутые технологии (например, [отладчики](https://code.visualstudio.com/docs/python/debugging) в IDE, то есть средах разработки), но они выходят за рамки данного курса. Очевидный совет: нужно размещать такой `print`, который помогает проверить гипотезу о происхождении ошибки. Предложение таких гипотез -- отдельный навык, который приходит с опытом, поначалу получается плохо "угадывать" и "понимать" ошибки.

В случае обращения по неверному индексу (`list index out of range`) логично предположить, что индекс оказался больше максимально возможного значения. Давайте выведем длину списка и индекс, по которому хотим обратиться:

```{figure} /_static/pythonblock/python_l11/example_debug.png
:name: example_debug
:width: 550px

Строчку с отладочным выводом легко потерять, для удобства можно добавлять символы или текст.
```

Аргументы выше явно указывают на причину ошибки. Этот случай тривиален, но он наглядно демонстрирует базовые приемы поиска причин ошибок. Еще один полезный прием -- разбитие "проблемной" строки кода на подстроки, то есть разнесение кода на отдельные изолированные куски. В примере выше в отдельную переменную был записан индекс. Попробуйте определить, в каком месте происходит ошибка в коде ниже:

```{figure} /_static/pythonblock/python_l11/debug_hard.png
:name: debug_hard
:width: 550px

Трейсбек ошибки указывает на функцию, при вызове которой возникла ошибка -- `third_f`
```

Это уже более сложный пример, когда трейсбек состоит из двух блоков. Указатель на ошибку как бы "проваливается" внутрь вызываемой функции и показывает, что не так. В данном случае ошибка `TypeError: unsupported operand type(s) for +: 'int' and 'str'` указывает на несовместимость типов операндов в операции сложения. Слева `int`, справа `str` -- как же их суммировать?

Исходная строчка, порождающая ошибку, слишком сложна. Мы вызываем функцию (`print`) от функции (`first_f`) от функции... Будь логика в коде чуть сложнее -- легко можно было бы запутаться, что именно породило ошибку (главное обращайте внимание на заголовки трейсбека, указывающие на названия методов и функций). С разбиением все проще:

```{figure} /_static/pythonblock/python_l11/debug_solved.png
:name: debug_solved
:width: 550px

Вуаля! Указатель в виде стрелочки прямо рапотрует о том, что проблема в вычислении `third_f`.  
Дальше можно было бы добавить `print(tmp1)`, чтобы увидеть входные параметры и попытаться понять причину проблемы.
```

На этом остановимся, блок обязательно будет дополняться по мере возникновения типовых ошибок и способов их поимки. Помните, что можно распечатать и аргументы функции/метода, и атрибуты класса (в том числе скрытые/промежуточные состояния квантовой среды), и результаты расчетов.

## Примеры кода, не разобранные в лекциях
Ранее весь код, который упоминался в лекциях (за вычетом примера из первой), был написан на чистом `Python` без сторонних библиотек, которые мы так нахваливали. В курсе они встретятся, так что поговорим об импортах библиотек и об их алиасах -- удобных для запоминания именах.

Чтобы использовать объект из сторонней библиотеки, будь то функция, класс или даже словарь (например, с физическими константами), нужно знать, в какой библиотеке и по какому пути он лежит. Все это описано в [документации](https://docs.python.org/3/tutorial/modules.html), а также в примерах кода в курсе. Не переживайте, если они плохо запоминаются -- чаще всего их копируют и со временем в голове откладывается паттерн. Рассмотрим получение доступа к библиотеке на примере библиотеки для алгебраических расчетов [`numpy`](https://numpy.org/). Сначала следует ключевое слово `import`, затем  -- через пробел -- название пакета. Опционально через `as` можно добавить так называемый алиас -- название, под которым можно будет обращаться в коде для доступа к функциям. У многих пакетов есть общепринятые алиасы, с которыми все знакомы. Для `numpy` это `np`. Итак,

```{code-cell} ipython3
import numpy as np

np_example_array = np.array([1,2,3])
print(f"{np_example_array.shape = }")

abs_res = np.abs(-2)
print(f"{abs_res = }")
```

По сути обращение схоже с объявлением объекта класса или же каким то методом, ведь можно импортировать не целый пакет, а его часть.

```{code-cell} ipython3
from numpy import zeros

zeros_matrix = zeros(shape=(1, 3))
print(f"{zeros_matrix = }")
```

Здесь `zeros` -- функция, формирующая матрицу из нулей заданного размера.

Для отрисовки визуализаций часто используют библиотеку `matplotlib` -- мы уже сталкивались с ней в прошлых лекциях:

```{code-cell} ipython3
import matplotlib.pyplot as plt

plt.scatter(np.random.randn(10), np.random.randn(10));
plt.show();
```
В коде выше в последних двух строчках стоит `;`. Это необязательный символ, означающий конец команды. В большинстве других языков программирования необходимо всегда в конце строки оставлять этот символ, однако в `Python` сигналом о конце инструкции служит перенос строки.

Почему же здесь они поставлены? Во-первых, чтобы показать, что они означают -- чтобы вы не переживали, когда встретите подобное. Во-вторых, `plt.show()` возвращает объект после вызова метода. `Jupyter` же по умолчанию выводит последнее возвращенное значение. Попробуйте убрать точку с запятой в своем ноутбуке и посмотреть, что выйдет. В данном случае окончание команды `;` говорит о том, что возвращаемая переменная никуда не будет записана и будет удалена, поэтому при ее наличии подпись объекта не возвращается.

В коде сначала происходит импорт, затем вызывается отрисовка точек (подробнее -- в [документации](https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.scatter.html?highlight=scatter#matplotlib.pyplot.scatter)), где координаты `X` и `Y` получаются случайно из нормального распределения от `-1` до `1`. Сам по себе вызов `scatter()` добавляет точки на график, но не отрисовывает его. За это отвечает вызов `plt.show()`. Непосредственно `plt` хранит в себе "полотно", на котором рисует, и результат добавления точек через `scatter` не нужно записывать в переменную -- все это хранится во внутреннем состоянии самой библиотеки. Помните урок про классы и их объекты, задающие состояние системы? Здесь ровно то же самое. Аналогичный функционал будет у библиотеки для квантовых вычислений, с которой вы познакомитесь далее по курсу (под алиасом `qml`).

## Блок дополнительных ссылок
Ниже представлен набор ссылок, которые можно посмотреть для расширения кругозора и лучшего усвоения материала. Это бонусный материал, необязательный к изучению. Но если вас захватила идея получше познакомится со своим инструментом, то почему нет?

1. [Курс по Python](https://github.com/trekhleb/learn-python) в виде примеров кода с очевидными и не очень механиками языка. Хорошо подойдет как дополнение к примерам в курсе.
2. [realpython](https://realpython.com/) -- сайт с большим количеством разнообразных уроков по `Python` на английском.
3. [Огромный список](https://github.com/kirang89/pycrumbs) ссылок на разные статьи по всем темам -- от основ `Python` и до продвинутых приемов в разработке.
4. [И другой](https://github.com/vinta/awesome-python) -- с набором ссылок на код разных программ. Игры, видеопроигрыватели и прочее -- все тут.
5. [Простой отладчик](https://github.com/alexmojaki/snoop) на случай, если начали путаться в своем коде, а продвинутые инструменты кажутся очень сложными и громоздкими.

Как ставить новые библиотеки в `Python` -- вот хотя бы тот же отладчик из пункта 5? Вспоминайте совет: поисковик -- ваш лучший друг. "how to install python library" (да, прямо дословно library = библиотека) -- и вы на коне!

## Вместо заключения
Что ж, вот и подошел к концу первый блок курса. Его можно назвать самым сложным -- не с точки зрения материала и его научности, но по количеству усилий, которые необходимо приложить, чтобы не сбиться с пути и продолжить обучение, несмотря на трудности. Именно тут большинство сдается и закрывает курс. Если ты, дорогой студент, читаешь это, то мы безумно рады за твои достижения и подвиги, желаем дальнейших успехов в прохождении курса!

```{figure} /_static/pythonblock/python_l11/cats_show_love_differently.jpeg
:name: cats_show_love_differently
:width: 350px
```
